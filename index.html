<!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <title>Notification Demo (ServiceWorker only)</title>
</head>
<body>
  <button id="btn-request">नोटिफिकेशन अनुमति माँगे</button>
  <button id="btn-test" disabled>टेस्ट नोटिफिकेशन भेजें</button>

<script>
(async function(){
  const btnRequest = document.getElementById('btn-request');
  const btnTest = document.getElementById('btn-test');

  // Inline Service Worker बनाओ
  const swCode = `
    self.addEventListener('install', e => self.skipWaiting());
    self.addEventListener('activate', e => e.waitUntil(self.clients.claim()));
    self.addEventListener('notificationclick', e => {
      e.notification.close();
      e.waitUntil(clients.openWindow('/'));
    });
  `;
  const swUrl = URL.createObjectURL(new Blob([swCode], {type:'text/javascript'}));
  const registration = await navigator.serviceWorker.register(swUrl);

  function updateUI(){
    btnRequest.disabled = (Notification.permission === 'granted');
    btnTest.disabled = (Notification.permission !== 'granted');
  }
  updateUI();

  btnRequest.onclick = async () => {
    const result = await Notification.requestPermission();
    updateUI();
    if(result === 'granted'){
      await registration.showNotification('धन्यवाद!', {
        body: 'आपने अनुमति दे दी।',
        icon: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAI0lEQVQYV2N8+vTpPwMDAwMjI+NfEAzEgBjoAGoY2gAAawUCpK9FYXQAAAAASUVORK5CYII='
      });
    }
  };

  btnTest.onclick = async () => {
    await registration.showNotification('हैलो!', {
      body: 'यह आपका टेस्ट नोटिफिकेशन है।',
      tag: 'demo'
    });
  };
})();
</script>
</body>
</html>