<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>MP3 List from Firebase</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background:#f4f4f4; padding:20px; }
    .card { background:white; padding:20px; border-radius:10px; max-width:800px; margin:auto; }
    textarea { width:100%; height:150px; margin-top:10px; }
    button { margin-top:10px; padding:6px 12px; background:#007bff; color:white; border:none; border-radius:5px; cursor:pointer; }
    button:hover { background:#0056b3; }
    ul { list-style:none; padding:0; }
    li { margin: 10px 0; padding:10px; border:1px solid #ddd; border-radius:6px; background:#fafafa; }
    audio { display:block; margin-top:5px; }
    .id { font-size:12px; color:#555; }
  </style>
</head>
<body>
  <div class="card">
    <h2>ğŸµ Firebase MP3 Idea List</h2>

    <!-- Upload + Save -->
    <input type="file" id="fileInput" accept="audio/mp3">
    <button onclick="convertToBase64()">Convert</button>
    <textarea id="output" placeholder="Base64 output..."></textarea>
    <button onclick="saveToFirebase()">ğŸ’¾ Save to Firebase</button>

    <!-- Show all data -->
    <h3>ğŸ“ Saved MP3s (from Firebase):</h3>
    <ul id="ideaList"></ul>
  </div>

  <script>
    // âœ… Firebase Config (à¤†à¤ªà¤•à¤¾)
    const firebaseConfig = {
      apiKey: "AIzaSyAa-r7rwMxNMZGKucXtwdHimKq77iX7MpM",
      authDomain: "grsc-chet.firebaseapp.com",
      databaseURL: "https://grsc-chet-default-rtdb.firebaseio.com",
      projectId: "grsc-chet",
      storageBucket: "grsc-chet.appspot.com",
      messagingSenderId: "1029401721470",
      appId: "1:1029401721470:web:c75cb33423c7f567ec362f"
    };

    // Init Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Convert file â†’ Base64
    function convertToBase64() {
      const file = document.getElementById('fileInput').files[0];
      if (!file) {
        alert("à¤•à¥ƒà¤ªà¤¯à¤¾ MP3 à¤«à¤¾à¤‡à¤² à¤šà¥à¤¨à¥‡à¤‚");
        return;
      }
      const reader = new FileReader();
      reader.onload = function() {
        const base64String = reader.result.split(',')[1];
        document.getElementById('output').value = base64String;
      };
      reader.readAsDataURL(file);
    }

    // Save to Firebase
    function saveToFirebase() {
      const text = document.getElementById('output').value;
      if (!text) {
        alert("à¤ªà¤¹à¤²à¥‡ Base64 à¤œà¤¨à¤°à¥‡à¤Ÿ à¤•à¤°à¥‡à¤‚");
        return;
      }
      const newIdeaRef = db.ref("ideas").push();
      newIdeaRef.set({
        preview: text.substring(0, 50) + "...",
        fullData: text,
        createdAt: new Date().toISOString()
      });
      alert("âœ… Firebase à¤®à¥‡à¤‚ à¤¸à¥‡à¤µ à¤¹à¥‹ à¤—à¤¯à¤¾!");
    }

    // Load all data from Firebase
    function loadIdeas() {
      const list = document.getElementById('ideaList');
      db.ref("ideas").on("value", snapshot => {
        list.innerHTML = "";
        snapshot.forEach(child => {
          const data = child.val();
          const key = child.key;

          const li = document.createElement("li");

          // Show Firebase ID
          const id = document.createElement("div");
          id.className = "id";
          id.textContent = "ID: " + key;
          li.appendChild(id);

          // Preview text
          const p = document.createElement("p");
          p.textContent = "Preview: " + data.preview;
          li.appendChild(p);

          // Audio player
          const audio = document.createElement("audio");
          audio.controls = true;
          audio.src = "data:audio/mp3;base64," + data.fullData;
          li.appendChild(audio);

          list.appendChild(li);
        });
      });
    }

    loadIdeas();
  </script>
</body>
</html>
